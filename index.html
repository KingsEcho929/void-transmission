<!DOCTYPE html>
<html>
<head>
  <title>Void Transmission Shrine</title>
</head>
<body>
  <h1>ðŸ“œ Void Transmission</h1>

  <div id="buttons"></div>
  <div id="status"></div>

  <script>
  async function loadRegistry() {
    const res = await fetch("/registry.json");
    const registry = await res.json();
    const buttonsDiv = document.getElementById("buttons");

    registry.daemons.forEach(daemon => {
      const btn = document.createElement("button");
      // Fallback: use daemon.name if no symbol is defined
      btn.textContent = daemon.symbol || daemon.name;

      btn.onclick = async () => {
        let payload = {};
        // Prompt logic based on daemon name
        if (daemon.name === "courier-keygen") {
          payload.courier = prompt("Enter courier name for keygen:");
        } else if (daemon.name === "courier-push") {
          payload.recipient = prompt("Enter recipient name:");
          payload.message = prompt("Enter message text:");
        } else if (daemon.name === "courier-pull") {
          payload.courier = prompt("Enter courier name:");
        } else if (daemon.name === "courier-burn") {
          payload.courier = prompt("Enter courier name to burn:");
        }
        const res = await fetch(`/${daemon.name}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        const result = await res.json();
        document.getElementById("status").innerText = result.status;
      };

      buttonsDiv.appendChild(btn);
    });
  }

  loadRegistry();
  </script>
</body>
</html>

